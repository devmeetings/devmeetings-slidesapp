extends layout


mixin footerContent(slide)
  .row
    .col-lg-12
      div!= slide.footer

mixin slideContent(slide)
    .row
      .col-lg-12
        div!= slide.text
        br
        if slide.code
          div
            span.editor-change-size.glyphicon.glyphicon-fullscreen
            .code-editor.editor(
              data-language='#{slide.code.language}'
              class="#{slide.code.small ? 'small' : ''} #{slide.code.big ? 'big' : ''}" 
              )= slide.code.content
    .row
      .col-lg-12
        .errors.alert.alert-danger.errors-code
    if slide.code
      br
      .output.row(data-monitor='#{slide.monitor}', data-hide="#{slide.code.hideOutput}", data-async=slide.code.async)
        .col-sm-6
          .output-ace.editor
        .col-sm-6
          .output-json
    if slide.fiddle
      .row
        div(class="#{ slide.fiddle.hideOutput ? 'col-sm-12' : 'col-sm-6' }")
          div
            ul.nav.nav-tabs.nav-fiddle
              if slide.fiddle.js
                li(class="#{slide.fiddle.active === 'js' ? 'active' : ''}")
                  a(data-toggle='tab', data-target="#tab-js") js
              if slide.fiddle.coffee
                li(class="#{slide.fiddle.active === 'coffee' ? 'active' : ''}")
                  a(data-toggle='tab', data-target="#tab-coffee") coffee
              if slide.fiddle.css
                li(class="#{slide.fiddle.active === 'css' ? 'active' : ''}")
                  a(data-toggle='tab', data-target="#tab-css") css
              if slide.fiddle.html
                li(class="#{slide.fiddle.active === 'html' ? 'active' : ''}")
                  a(data-toggle='tab', data-target="#tab-html") html

            span.editor-change-size.glyphicon.glyphicon-fullscreen
            .tab-content
              #tab-js.tab-pane.fade(class="#{slide.fiddle.active === 'js' ? 'active in' : ''}") 
                #editor-js.editor(
                  class="#{slide.fiddle.small ? 'small' : ''} #{slide.fiddle.big ? 'big' : ''}" )= slide.fiddle.js
              #tab-coffee.tab-pane.fade(class="#{slide.fiddle.active === 'coffee' ? 'active in' : ''}") 
                #editor-coffee.editor(
                  class="#{slide.fiddle.small ? 'small' : ''} #{slide.fiddle.big ? 'big' : ''}" )= slide.fiddle.coffee
              #tab-css.tab-pane.fade(
                class="#{slide.fiddle.active === 'css' ? 'active in' : ''}")
                #editor-css.editor(
                  class="#{slide.fiddle.small ? 'small' : ''} #{slide.fiddle.big ? 'big' : ''}" )!= slide.fiddle.css
              #tab-html.tab-pane.fade(
                class="#{slide.fiddle.active === 'html' ? 'active in' : ''}")
                if slide.fiddle.html
                  #editor-html.editor(
                    class="#{slide.fiddle.small ? 'small' : ''} #{slide.fiddle.big ? 'big' : ''}" )= slide.fiddle.html
                else
                  #editor-html.editor(
                    class="#{slide.fiddle.small ? 'small' : ''} #{slide.fiddle.big ? 'big' : ''}" ) #{"<html><head></head><body></body></html>"}
            .errors.alert.alert-danger.errors-fiddle
        .col-sm-6(class="#{ slide.fiddle.hideOutput ? 'hidden' : '' }")
          #tab-output.tab-pane #{slide.fiddle.output}
            form.form-inline.fiddle-output-controls(role="form")
              .form-group
                input.input-sm.form-control#iframe-width(type="number", placeholder="Width 1024px", step="10")
              .form-group
                input.input-sm.form-control#iframe-scale(type="number", placeholder="Scale 100", step="5")
            iframe#fiddle-output(data-pure=slide.fiddle.pure)

    if slide.task
      .row
        .col-md-9
          h1 
            span.text-success
              span.glyphicon.glyphicon-check
            |  Objectives
          ol
            for o in slide.task.objectives
              li 
                h4 !{o}
          h2
            span.text-danger
              span.glyphicon.glyphicon-asterisk
            |  Extra objectives
          ol
            for o in slide.task.extras
              li
                h4 !{o}
        .col-md-3
          h1 
            span.glyphicon.glyphicon-time
            | 
            span.text-warning.task-time-left(data-duration=slide.task.duration)
              | #{slide.task.duration} 
            span.text-warning
              |  min

            button.task-start-btn.btn.btn-default.pull-right(
              data-toggle="tooltip",
              title="Start task")
              span.glyphicon.glyphicon-play
          hr
          h2
            span.glyphicon.glyphicon-play
            | 
            span.task-start-time
          h2
            span.glyphicon.glyphicon-pause
            | 
            span.task-end-time
    mixin footerContent(slide)
block content
    

  .main-content.fade.container-fluid(data-slide-id=slide.id, data-slideset=slideset, data-trainers-mode=isTrainers)
    .row
      .col-lg-12
        h1!= slide.title
    if slide.left
      .col-md-7
        mixin slideContent(slide.left)
    if slide.right
      .col-md-5
        mixin slideContent(slide.right)
    if !slide.left && !slide.right
      mixin slideContent(slide)
      .clearfix
      mixin footerContent(slide)
    else
      .clearfix
      mixin footerContent(slide)
    // Display microtasks
    if slide.microtasks
      .microtasks
        for task in slide.microtasks
          .microtask.alert.alert-danger(data-toggle="tooltip", data-placement="left", title=task.hint,
            data-css=task.css, data-js=task.js, data-html=task.html, data-output=task.output, data-js-assert="#{task.js_assert ? task.js_assert.trim() : true}")
            span.microtask-status
              span.glyphicon.glyphicon-ok.microtask-status-ok
              span.glyphicon.glyphicon-question-sign.text-warning.microtask-status-bad
              | &nbsp;
            span.microtask-text!= task.description

    .clearfix
    


            


prepend styles
  link(href="css/inspector-json.css", rel="stylesheet")
append scripts
  script(src='js/coffee-script.js')
  script(src="js/jquery.hotkeys.js")
  script(src="js/inspector-json.js")
  script(src="js/ace-builds/src-noconflict/ace.js")
  script(src="js/howler.js")
  script(src="js/utils.js")
  script(src="js/slide.js")
  if slide.script
    script!= slide.script

