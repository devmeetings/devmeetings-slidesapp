---
- name: install meteor
  shell: curl https://install.meteor.com | /bin/sh
  args:
    creates: /usr/bin/meteor

- name: Remove App
  file:
    dest: /srv/xplatform/x-dashboard/build
    state: absent

- name: Build App
  command: meteor build build
  args:
    chdir: /srv/xplatform/x-dashboard

- name: Extract App
  unarchive:
    copy: no
    src: /srv/xplatform/x-dashboard/build/x-dashboard.tar.gz
    dest: /srv/xplatform/x-dashboard/build

- name: Install NPM Modules
  npm: path=/srv/xplatform/x-dashboard/build/bundle/programs/server

- name: Copying run script
  copy: 
    src: run_platform
    dest: /srv/run_platform
    owner: xplatform
    mode: '0755'


